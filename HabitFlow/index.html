<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Striide</title>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --primary: #000;
  --accent: #6c63ff;
  --bg: #f6f7fb;
  --card: #fff;
  --text: #222;
  --muted: #777;
  --radius: 18px;
}

/* Global */
* { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
body { margin: 0; background: var(--bg); color: var(--text); }

/* Header */
header { padding: 20px; }
header h1 { margin: 0; font-size: 26px; }
header small { color: var(--muted); }

/* Greeting & Date */
#greeting { font-size: 28px; font-weight: 800; padding: 0 20px 5px; }
#currentDate { font-size: 16px; color: var(--muted); padding-left: 20px; }

/* Top Navigation */
.top-nav { display: flex; gap: 10px; padding: 10px 20px; }
.top-nav button { flex: 1; padding: 10px; border-radius: 14px; border: none; background: #eee; font-weight: 600; }
.top-nav button.active { background: var(--accent); color: white; }

/* Pages */
.page { display: none; padding-bottom: 100px; }
.page.active { display: block; }

/* Habit Card */
.habit-card { background: var(--card); margin: 15px 20px; padding: 16px; border-radius: var(--radius); box-shadow: 0 10px 20px rgba(0,0,0,0.05); transition: transform 0.2s; }
.habit-card:hover { transform: translateY(-2px); }
.habit-header { display: flex; justify-content: space-between; align-items: center; }
.habit-header h3 { margin: 0; font-size: 18px; font-weight: 600; }
.delete-btn { border: none; background: none; font-size: 20px; cursor: pointer; transition: transform 0.2s; }
.delete-btn:hover { transform: scale(1.2); }

/* Week */
.week { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; margin-top: 14px; }
.day { text-align: center; font-size: 12px; display: flex; flex-direction: column; align-items: center; gap: 5px; }
.day span.weekday { font-weight: 600; font-size: 14px; }
.day span.date { font-size: 12px; color: var(--muted); }

/* Premium animated gradient checkbox */
.day input[type=checkbox] {
  appearance: none;
  width: 28px; height: 28px;
  border-radius: 8px;
  border: 2px solid #ccc;
  cursor: pointer;
  position: relative;
  transition: all 0.3s ease;
  background: #fff;
}
.day input[type=checkbox]:checked {
  background: linear-gradient(135deg,#6c63ff,#00d4ff);
  border: none;
  transform: scale(1.1);
  box-shadow: 0 0 8px rgba(108,99,255,0.6);
}
.day input[type=checkbox]:checked::after {
  content: '‚úî';
  position: absolute;
  top: 2px; left: 6px;
  font-size: 18px;
  color: #fff;
  animation: bounce 0.3s;
}
@keyframes bounce {
  0% { transform: scale(0); opacity:0; }
  50% { transform: scale(1.3); opacity:1; }
  100% { transform: scale(1); opacity:1; }
}

/* Add Habit Input & Button */
#habitInput { width: 100%; padding: 14px; border-radius: 14px; border: 1px solid #ccc; }
.add-btn { margin-top: 10px; background: #000; color: #fff; border: none; padding: 14px 24px; border-radius: 30px; font-size: 16px; font-weight: 600; cursor: pointer; }

/* Analytics */
.analytics-box { background: var(--card); margin: 20px; padding: 20px; border-radius: var(--radius); }
.toggle { display: flex; gap: 10px; margin-bottom: 10px; }
.toggle button { flex: 1; padding: 10px; border-radius: 12px; border: none; background: #eee; }
.toggle button.active { background: var(--accent); color: white; }

/* Settings */
.analytics-box button { padding: 10px 16px; border: none; border-radius: 12px; background: #000; color: #fff; cursor: pointer; }

/* Name Prompt */
#nameOverlay { position: fixed; inset: 0; background: white; display: flex; align-items: center; justify-content: center; z-index: 999; }
.name-box { text-align: center; }
.name-box input { padding: 12px; border-radius: 12px; border: 1px solid #ccc; width: 220px; margin-top: 10px; }
canvas { width: 100% !important; height: auto !important; }
</style>
</head>

<body>

<div id="nameOverlay">
  <div class="name-box">
    <h2>Welcome to Striide</h2>
    <p>Your name?</p>
    <input id="nameInput" placeholder="Enter your name"/>
    <br/><br/>
    <button class="add-btn" onclick="saveName()">Continue</button>
  </div>
</div>

<header>
  <h1>Striide</h1>
  <small>created with ‚ù§Ô∏è by Manas</small>
</header>

<div class="top-nav">
  <button class="active" onclick="switchPage('home', this)">Home</button>
  <button onclick="switchPage('analytics', this)">Analytics</button>
  <button onclick="switchPage('settings', this)">Settings</button>
</div>

<div id="greeting"></div>
<div id="currentDate"></div>

<!-- HOME -->
<div id="home" class="page active">
  <div style="padding: 0 20px;">
    <input id="habitInput" placeholder="Enter habit name">
    <br><br>
    <button class="add-btn" onclick="addHabit()">Add Habit</button>
  </div>
  <div id="habitList"></div>
</div>

<!-- ANALYTICS -->
<div id="analytics" class="page">
  <div class="analytics-box">
    <div class="toggle">
      <button class="active" onclick="showAnalytics('week', this)">Weekly</button>
      <button onclick="showAnalytics('month', this)">Monthly</button>
    </div>
    <div style="position:relative; width:100%; height:280px;">
      <canvas id="analyticsChart"></canvas>
    </div>
  </div>
</div>

<!-- SETTINGS -->
<div id="settings" class="page">
  <div class="analytics-box">
    <p><strong>Name:</strong> <span id="userName"></span></p>
    <button onclick="resetApp()">Reset App</button>
  </div>
</div>

<script>
const dayNames = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
let habits = JSON.parse(localStorage.getItem("habits")) || [];

function getWeekStart(date=new Date()) {
  const day = date.getDay();
  const diff = (day + 6) % 7;
  const weekStart = new Date(date);
  weekStart.setDate(date.getDate() - diff);
  weekStart.setHours(0,0,0,0);
  return weekStart;
}

function saveName() {
  const name = document.getElementById("nameInput").value.trim();
  if (!name) return;
  localStorage.setItem("username", name);
  document.getElementById("nameOverlay").style.display = "none";
  loadUser();
}

function loadUser() {
  const name = localStorage.getItem("username");
  if (!name) return;
  document.getElementById("greeting").innerText = `Good Morning, ${name}`;
  document.getElementById("userName").innerText = name;
}

function updateCurrentDate() {
  const today = new Date();
  document.getElementById("currentDate").innerText = today.toLocaleDateString(undefined, { weekday:'long', year:'numeric', month:'short', day:'numeric'});
}
updateCurrentDate();
setInterval(updateCurrentDate, 60000);

function resetWeekIfNeeded() {
  const today = new Date();
  habits.forEach(habit => {
    if(!habit.weekStart || new Date(habit.weekStart).getTime() < getWeekStart().getTime()){
      habit.weekStart = getWeekStart().toISOString();
      habit.days = Array(7).fill(false);
    }
    if(!habit.history) habit.history={};
  });
  localStorage.setItem("habits", JSON.stringify(habits));
}

function renderHabits() {
  resetWeekIfNeeded();
  const home = document.getElementById("habitList");
  home.innerHTML = "";

  const weekStart = getWeekStart();
  const today = new Date();

  habits.forEach((habit,i)=>{
    const card = document.createElement("div");
    card.className="habit-card";

    let weekHtml="";
    for(let j=0;j<7;j++){
      const dayDate = new Date(weekStart);
      dayDate.setDate(dayDate.getDate()+j);
      const checked = habit.days[j] ? 'checked' : '';
      const disabled = dayDate>today ? 'disabled' : '';
      weekHtml += `
        <div class="day">
          <span class="weekday">${dayNames[j]}</span>
          <span class="date">${dayDate.getDate()}/${dayDate.getMonth()+1}</span>
          <input type="checkbox" ${checked} ${disabled} onchange="toggleDay(${i},${j},'${dayDate.toISOString()}')">
        </div>`;
    }

    card.innerHTML=`
      <div class="habit-header">
        <h3>${habit.name}</h3>
        <button class="delete-btn" onclick="deleteHabit(${i})">üóë</button>
      </div>
      <div class="week">${weekHtml}</div>`;
    home.appendChild(card);
  });

  localStorage.setItem("habits", JSON.stringify(habits));
}

function addHabit() {
  const input = document.getElementById("habitInput");
  const name = input.value.trim();
  if(!name) return;
  habits.push({ name, days: Array(7).fill(false), weekStart: getWeekStart().toISOString(), history:{} });
  input.value='';
  renderHabits();
}

function deleteHabit(i){
  habits.splice(i,1);
  renderHabits();
}

function toggleDay(h,d,dateISO){
  const dayDate = new Date(dateISO);
  const today = new Date();
  today.setHours(0,0,0,0);
  if(dayDate>today) return;
  habits[h].days[d] = !habits[h].days[d];
  habits[h].history[dateISO.split('T')[0]] = habits[h].days[d];
  localStorage.setItem("habits", JSON.stringify(habits));
  renderHabits();
}

// Analytics - Premium Gradient & Glow
let chartInstance = null;

function showAnalytics(type, btn){
  document.querySelectorAll('.toggle button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');

  const today = new Date();

  if(type==='week'){
    const weekStart = getWeekStart();
    const labels = dayNames;
    const data = [];
    for(let j=0;j<7;j++){
      let daySum=0, habitsCount=0;
      const dayDate = new Date(weekStart); dayDate.setDate(dayDate.getDate()+j);
      habits.forEach(h=>{
        if(dayDate <= today){
          habitsCount++;
          if(h.days[j]) daySum++;
        }
      });
      data.push(habitsCount>0 ? Math.round(daySum/habitsCount*100) : 0);
    }
    renderChart(labels,data,'week');
  } else {
    const month = today.getMonth();
    const year = today.getFullYear();
    const lastDay = new Date(year, month+1, 0).getDate();
    const labels = [];
    const data = [];
    for(let d=1;d<=lastDay;d++){
      labels.push(d);
      const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
      let sum=0,count=0;
      habits.forEach(h=>{
        if(h.history[dateStr]!==undefined){
          count++;
          if(h.history[dateStr]) sum++;
        }
      });
      const dayDate = new Date(year,month,d);
      data.push(dayDate>today?0:(count>0?Math.round(sum/count*100):0));
    }
    renderChart(labels,data,'month');
  }
}

function renderChart(labels,data,type){
  const ctx = document.getElementById('analyticsChart').getContext('2d');
  if(chartInstance) chartInstance.destroy();

  const gradient = ctx.createLinearGradient(0,0,0,280);
  gradient.addColorStop(0,'rgba(108,99,255,0.5)');
  gradient.addColorStop(1,'rgba(108,99,255,0)');

  chartInstance = new Chart(ctx,{
    type:'line',
    data:{
      labels:labels,
      datasets:[{
        label:'% Completion',
        data:data,
        borderColor:'#6c63ff',
        backgroundColor:gradient,
        fill:true,
        tension:0.4,
        borderWidth:3,
        pointRadius:6,
        pointHoverRadius:10,
        pointBackgroundColor: '#6c63ff',
        pointHoverBackgroundColor: '#00d4ff',
        pointBorderColor: '#fff',
      }]
    },
    options:{
      responsive:true,
      maintainAspectRatio:false,
      plugins:{
        legend:{display:false},
        tooltip:{mode:'index', intersect:false}
      },
      scales:{
        y:{beginAtZero:true, max:100, ticks:{callback: val => val+'%', font:{size:12}}},
        x:{ticks:{font:{size:12}}}
      }
    }
  });
}

function switchPage(id,btn){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll(".top-nav button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
  if(id==='home') renderHabits();
  if(id==='analytics') showAnalytics('week',document.querySelector('.toggle button.active'));
}

function resetApp(){
  localStorage.clear();
  location.reload();
}

if(!localStorage.getItem("username")){
  document.getElementById("nameOverlay").style.display="flex";
}else{
  document.getElementById("nameOverlay").style.display="none";
  loadUser();
  renderHabits();
}
</script>

</body>
</html>